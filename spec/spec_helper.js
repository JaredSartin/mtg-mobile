(function(){var h,old_jfx_value,selector_fix,__slice=[].slice;old_jfx_value=null,beforeEach(function(){return old_jfx_value=$.fx.off,$.fx.off=!0}),afterEach(function(){return $.fx.off=old_jfx_value}),h={},h.el_selector="#sandbox",h.el=function(){return $(h.el_selector)},h.dialog=function(){return $("#drewbox")},h.search_element=function(){return h.dialog().is(":visible")?h.dialog():h.el()},h.field=function(e){return h.search_element().find(selector_fix(e)).html()},h.find=function(e){return h.search_element().find(e)},h.text=function(e){return h.search_element().find(selector_fix(e)).text().trim()},h.see_dialog=function(){return expect(h.dialog().is(":visible")).toBeTruthy()},h.see_no_dialog=function(){return expect(h.dialog().is(":hidden")||!h.dialog().exists()).toBeTruthy()},h.cleanup_dialog=function(){if(h.dialog().is(":visible"))return $.drewbox.close()},h.disable_form_submission=function(e){return e.bind("ajax:before",function(){return!1})},h.should_exist=function(e){return expect(h.search_element().find(e).exists()).toBeTruthy()},h.exist=function(e){return h.search_element().find(e).exists()},h.has_class=function(e,t){return h.search_element().find(selector_fix(e)).hasClass(t)},h.data=function(e,t){return h.search_element().find(selector_fix(e)).hasClass(t)},h.attr=function(e,t){return h.search_element().find(e).attr(t)},h.value=function(e){return h.search_element().find(e).val()},h.is_empty=function(e){return _($(e).html().trim()).isEmpty()},h.has_focus=function(e){return $(e).get(0)===$(e).get(0).ownerDocument.activeElement},h.args_for=function(e){return e.args[0][0]},h.click=function(e){var t;return t=h.search_element().find(selector_fix(e)),t.click()},window.h=h,selector_fix=function(e){return e[0]==="."||e[0]==="#"?e:"."+e},beforeEach(function(){return setFixtures(sandbox()),this.fakes=sinon.create(sinon.collection),h.fakes=this.fakes}),afterEach(function(){return this.fakes.verifyAndRestore(),h.stubbed_methods={}}),h.create_stub=function(){var item,method,methodz,name,name_is_already_a_function,stub,stub_basename,target,the_function,the_stub,_i,_j,_k,_len,_len1,_len2,_ref,_results;target=arguments[0],name=arguments[1],methodz=3<=arguments.length?__slice.call(arguments,2):[],name_is_already_a_function=!1;try{if(!_.isFunction(eval(name)))throw""+name+" is not a function - treating as object";stub=eval(name),name_is_already_a_function=!0}catch(_error){}if(name_is_already_a_function){the_function=window,_ref=name.split(".");for(_i=0,_len=_ref.length;_i<_len;_i++)item=_ref[_i],the_function=the_function[item];stub_basename=InflectionJS.underscore(_.last(name.split("."))),h.stubbed_methods||(h.stubbed_methods={}),_results=[];for(_j=0,_len1=methodz.length;_j<_len1;_j++)method=methodz[_j],the_stub=null,h.stubbed_methods[""+name+"_"+method]?the_stub=h.stubbed_methods[""+name+"_"+method]:(the_stub=h.fakes.stub(the_function,method),h.stubbed_methods[""+name+"_"+method]=the_stub),_results.push(target[""+stub_basename+"_"+method]=the_stub);return _results}stub={},_.extend(stub,Backbone.Events);for(_k=0,_len2=methodz.length;_k<_len2;_k++)method=methodz[_k],stub[method]=function(){},target[""+name+"_"+method]=h.fakes.stub(stub,method);return target[name]=stub},h.expectEvent=function(){var e,t,n,r,i,s;return s=arguments[0],r=arguments[1],t=3<=arguments.length?__slice.call(arguments,2):[],i=!1,n=void 0,e=0,s.bind(r,function(){var r;r=1<=arguments.length?__slice.call(arguments,0):[],n=r,i=!0;if(!t||_.isEqual(t,n))return e+=1}),function(r){return r&&r.firesAfter&&(expect(i).toBe(!1),r.firesAfter()),expect(i).toBe(!0),t&&e!==1&&expect(t).toEqual(n),expect(e).toEqual(1)}},h.expectNoEvent=function(e,t){var n;return n=!1,e.bind(t,function(e){return n=!0}),function(e){return e&&(expect(n).toBe(!1),e()),expect(n).toBe(!1)}}}).call(this);